# cilium-values.yaml

# --- General settings ---
k8sServiceHost: "192.168.49.2" # from minikube ip
k8sServicePort: 8443
kubeProxyReplacement: true # uses eBPF to replace kube-proxy
hostServices:
    enabled: true
externalIPs:
    enabled: true

# --- Networking ---
ipam:
    mode: kubernetes # pod IPs managed by Cilium
routingMode: tunnel # overlay; for cloud, can switch to 'disabled' (direct routing or ENI)
tunnelProtocol: vxlan
autoDirectNodeRoutes: false
enableIPv4Masquerade: true
enableIPv6Masquerade: false

# --- Policy enforcement ---
policyEnforcementMode: default # can be 'always', 'default', or 'never'

# --- Hubble (observability) ---
hubble:
    enabled: true
    metrics:
        enableOpenMetrics: true
        enabled:
            - "flow:sourceContext=identity;destinationContext=identity;trafficDirection"
            - "drop:sourceContext=identity;destinationContext=identity;trafficDirection"
            - "tcp:sourceContext=identity;destinationContext=identity;trafficDirection"
            - "dns:sourceContext=identity;destinationContext=identity;trafficDirection"
            - "icmp:sourceContext=identity;destinationContext=identity;trafficDirection"
            - "httpV2:sourceContext=identity;destinationContext=identity;trafficDirection"
    relay:
        enabled: true
    ui:
        enabled: true

# --- KubeProxy replacement ---
bpf:
    masquerade: true
    tproxy: true
    hostRouting: true

# --- NodePort / Services ---
enableNodePort: true
enableHostPort: true
nodePort:
    enableHealthCheck: true
# --- Optional (for later) ---
# eni:
#   enabled: true
# ipam:
#   mode: eni
