syntax = "proto3";

package loco.workspace.v1;

import "google/protobuf/timestamp.proto";

option go_package = "github.com/loco-team/loco/shared/proto/workspace/v1;workspacev1";

service WorkspaceService {
  rpc CreateWorkspace(CreateWorkspaceRequest) returns (CreateWorkspaceResponse);
  rpc GetWorkspace(GetWorkspaceRequest) returns (GetWorkspaceResponse);
  rpc GetUserWorkspaces(GetUserWorkspacesRequest) returns (GetUserWorkspacesResponse);
  rpc ListWorkspaces(ListWorkspacesRequest) returns (ListWorkspacesResponse);
  rpc UpdateWorkspace(UpdateWorkspaceRequest) returns (UpdateWorkspaceResponse);
  rpc DeleteWorkspace(DeleteWorkspaceRequest) returns (DeleteWorkspaceResponse);
  rpc AddMember(AddMemberRequest) returns (AddMemberResponse);
  rpc RemoveMember(RemoveMemberRequest) returns (RemoveMemberResponse);
  rpc ListMembers(ListMembersRequest) returns (ListMembersResponse);
}

message Workspace {
  int64 id = 1;
  int64 org_id = 2;
  string name = 3;
  string description = 4;
  int64 created_by = 5;
  google.protobuf.Timestamp created_at = 6;
  google.protobuf.Timestamp updated_at = 7;
}

message WorkspaceMember {
  int64 workspace_id = 1;
  int64 user_id = 2;
  string role = 3;
  google.protobuf.Timestamp created_at = 4;
}

message CreateWorkspaceRequest {
  int64 org_id = 1;
  string name = 2;
  optional string description = 3;
}

message CreateWorkspaceResponse {
  Workspace workspace = 1;
}

message GetWorkspaceRequest {
  int64 id = 1;
}

message GetWorkspaceResponse {
  Workspace workspace = 1;
}

message GetUserWorkspacesRequest {}

message GetUserWorkspacesResponse {
  repeated Workspace workspaces = 1;
}

message ListWorkspacesRequest {
  int64 org_id = 1;
}

message ListWorkspacesResponse {
  repeated Workspace workspaces = 1;
}

message UpdateWorkspaceRequest {
  int64 id = 1;
  optional string name = 2;
  optional string description = 3;
}

message UpdateWorkspaceResponse {
  Workspace workspace = 1;
}

message DeleteWorkspaceRequest {
  int64 id = 1;
  bool confirm_delete_apps = 2;
}

message DeleteWorkspaceResponse {
  bool success = 1;
}

message AddMemberRequest {
  int64 workspace_id = 1;
  int64 user_id = 2;
  string role = 3;
}

message AddMemberResponse {
  WorkspaceMember member = 1;
}

message RemoveMemberRequest {
  int64 workspace_id = 1;
  int64 user_id = 2;
}

message RemoveMemberResponse {
  bool success = 1;
}

message ListMembersRequest {
  int64 workspace_id = 1;
}

message ListMembersResponse {
  repeated WorkspaceMember members = 1;
}
